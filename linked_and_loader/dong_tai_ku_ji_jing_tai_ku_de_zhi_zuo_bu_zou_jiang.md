# 动态库及静态库的制作步骤讲解


首先回答前面的问题，一共有多少种方法来指定告诉linux共享库链接器ld.so已经编译好的库libbase.so的位置呢？答案是一共有五种，它们都可以通知ld.so去哪些地方找下已经编译好的c语言函数动态库，它们是：

    1）ELF可执行文件中动态段中DT_RPATH所指定的路径。即在编译目标代码时, 对gcc加入链接参数“-Wl,-rpath”指定动态库搜索路径，eg：gcc -Wl,-rpath,/home/arc/test,-rpath,/lib/,-rpath,/usr/lib/,-rpath,/usr/local/lib test.c

    2）环境变量LD_LIBRARY_PATH 指定的动态库搜索路径

    3）/etc/ld.so.cache中所缓存的动态库路径，这个可以通过先修改配置文件/etc/ld.so.conf中指定的动态库搜索路径，然后执行ldconfig命令来改变。

    4）默认的动态库搜索路径/lib

    5）默认的动态库搜索路径/usr/lib

    另外：在嵌入式Linux系统的实际应用中，1和2被经常使用，也有一些相对简单的的嵌入式系统会采用4或5的路径来规范动态库，3在嵌入式系统中使用的比较少, 因为有很多系统根本就不支持ld.so.cache。

    那么，动态链接器ld.so在这五种路径中，是按照什么样的顺序来搜索需要的动态共享库呢？答案这里先告知就是按照上面的顺序来得，即优先级是：`1-->2-->3-->4-->5`。我们可以写简单的程序来证明这个结论。

 